---
import BaseLayout from "@/components/base/BaseLayout.astro";
import FriendLinks from "@/components/common/FriendLinks.astro";
import Comment from "@components/base/Comment.astro";
import GlassButton from "@components/ui/GlassButton.astro";
import { SITE_INFO } from "@lib/config";
import LiquidGlassLess from "./LiquidGlassLess.astro";

// 友链朋友圈样式
import "@/assets/styles/fc.css";
---

<BaseLayout
  title="友情链接 - 交换友链申请"
  description="欢迎申请友情链接交换，共同建设更好的网络社区"
>
  <section class="container px-3 lg:px-8">
    <LiquidGlassLess
      wrapperClass="panel"
      heavy textClass="w-full rounded-[35px] p-6 lg:p-8"
    >
    <!-- <div
      class="bg-[#f8f9ff] dark:bg-zinc-900 border border-gray-200 dark:border-zinc-800 shadow-md w-full rounded-[35px] p-6 lg:p-8"
    > -->
      <!-- 页面标题 -->
      <div class="text-center mb-4">
        <div class="">
          <h1 class="text-2xl font-bold text-gradient-primary mb-2">
            友情链接
          </h1>
        </div>
      </div>

      <!-- 友链展示区域 -->
      <div class="mb-8 animate-fade-in-up" style="animation-delay: 0.2s">
        <FriendLinks />
      </div>

      <!-- 友链朋友圈 -->
      <div class="mb-8 animate-fade-in-up" style="animation-delay: 0.4s">
        <h2 id='small-circle'>朋友圈</h2>

        <div id='friend-circle-lite-root' class='not-prose bg-gray-300/30 dark:bg-gray-800/30 backdrop-blur-md rounded-[25px] p-6 border border-white/20 dark:border-gray-700/30'>Loading...</div>

        <script is:inline>
           // 直接在客户端脚本中定义 FriendCircle 类
           class FriendCircle {
              config = {
                 private_api_url: 'https://fc.mcyzsx.top/',
                 page_turning_number: 10,
                 error_img: 'https://cravatar.cn/avatar/57d8260dfb55501c37dde588e7c3852c'
              }
              root
              start = 0
              allArticles = []
              container
              randomArticleContainer
              statsContainer
              loadMoreBtn
              modal

              load() {
                 this.loadMoreArticles()
                 this.loadMoreBtn.addEventListener('click', this.loadMoreArticles.bind(this))
                 window.onclick = (event) => {
                    const modal = document.getElementById('modal')
                    if (event.target === modal) {
                       this.hideModal()
                    }
                 }
              }

              init(config) {
                 this.config = {
                    private_api_url: config.private_api_url || this.config.private_api_url,
                    page_turning_number: config.page_turning_number || this.config.page_turning_number,
                    error_img: config.error_img || this.config.error_img
                 }

                 this.root = document.getElementById('friend-circle-lite-root')
                 if (!this.root) return

                 this.root.innerHTML = ''
                 this.createContainers()
              }

              createContainers() {
                 this.randomArticleContainer = this.createElement('div', { id: 'random-article' })
                 this.container = this.createElement('div', {
                    className: 'articles-container',
                    id: 'articles-container'
                 })
                 this.loadMoreBtn = this.createElement('button', {
                    id: 'load-more-btn',
                    innerText: 'Load more'
                 })
                 this.statsContainer = this.createElement('div', { id: 'stats-container' })

                 this.root.append(
                    this.randomArticleContainer,
                    this.container,
                    this.loadMoreBtn,
                    this.statsContainer
                 )
              }

              createElement(tag, attributes) {
                 const element = document.createElement(tag)
                 Object.assign(element, attributes)
                 return element
              }

              loadMoreArticles() {
                 const cacheKey = 'friend-circle-lite-cache'
                 const cacheTimeKey = 'friend-circle-lite-cache-time'
                 const cacheTime = localStorage.getItem(cacheTimeKey)
                 const now = Date.now()

                 if (cacheTime && now - Number(cacheTime) < 10 * 60 * 1000) {
                    const cachedDataString = localStorage.getItem(cacheKey)
                    const cachedData = cachedDataString ? JSON.parse(cachedDataString) : null
                    if (cachedData) {
                       this.processArticles(cachedData)
                       return
                    }
                 }

                 fetch(`${this.config.private_api_url}all.json`)
                    .then((response) => response.json())
                    .then((data) => {
                       localStorage.setItem(cacheKey, JSON.stringify(data))
                       localStorage.setItem(cacheTimeKey, now.toString())
                       this.processArticles(data)
                    })
                    .finally(() => {
                       this.loadMoreBtn.innerText = 'Load more'
                    })
              }

              processArticles({ article_data, statistical_data }) {
                 this.allArticles = article_data
                 this.updateStats(statistical_data)
                 this.displayRandomArticle()
                 this.displayArticles()
              }

              updateStats(stats) {
                 this.statsContainer.innerHTML = `
                    <div>${stats.friends_num} links with ${stats.active_num} active | ${stats.article_num} articles in total</div>
                    <div>Updated at ${stats.last_updated_time}</div>
                    <div>Powered by <a href="https://github.com/willow-god/Friend-Circle-Lite" target="_blank">FriendCircleLite</a><br></div>
                 `
              }

              displayArticles() {
                 const articles = this.allArticles.slice(
                    this.start,
                    this.start + this.config.page_turning_number
                 )
                 articles.forEach((article) => this.createArticleCard(article))
                 this.start += this.config.page_turning_number

                 if (this.start >= this.allArticles.length) {
                    this.loadMoreBtn.style.display = 'none'
                 }
              }

              createArticleCard(article) {
                 const card = document.createElement('div')
                 card.className = 'article'
                 card.innerHTML = `
                    <div class="article-image author-click">
                       <img class="no-lightbox" src="${article.avatar || this.config.error_img}" onerror="this.src='${this.config.error_img}'">
                    </div>
                    <div class="article-container">
                       <div class="article-author author-click">${article.author}</div>
                       <a class="article-title" href="${article.link instanceof URL ? article.link.toString() : article.link}" target="_blank">${article.title}</a>
                       <div class="article-date">️${article.created.substring(0, 10)}</div>
                    </div>
                 `
                 card.querySelectorAll('.author-click').forEach((el) => {
                    el.addEventListener('click', () => {
                       this.showAuthorArticles(article.author, article.avatar, article.link)
                    })
                 })
                 this.container.appendChild(card)
              }

              displayRandomArticle() {
                 const randomArticle = this.allArticles[Math.floor(Math.random() * this.allArticles.length)]
                 this.randomArticleContainer.innerHTML = `
                    <div class="random-title">Random Poll</div>
                    <div class="article-container">
                       <div class="article-author">${randomArticle.author}</div>
                       <a class="article-title" href="${randomArticle.link}" target="_blank">${randomArticle.title}</a>
                       <div class="article-date">️${randomArticle.created.substring(0, 10)}</div>
                    </div>
                    <button id="random-refresh">
                       <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><g fill="none"><path d="M24 0v24H0V0zM12.593 23.258l-.011.002l-.071.035l-.02.004l-.014-.004l-.071-.035q-.016-.005-.024.005l-.004.01l-.017.428l.005.02l.01.013l.104.074l.015.004l.012-.004l.104-.074l.012-.016l.004-.017l-.017-.427q-.004-.016-.017-.018m.265-.113l-.013.002l-.185.093l-.01.01l-.003.011l.018.43l.005.012l.008.007l.201.093q.019.005.029-.008l.004-.014l-.034-.614q-.005-.019-.02-.022m-.715.002a.02.02 0 0 0-.027.006l-.006.014l-.034.614q.001.018.017.024l.015-.002l.201-.093l.01-.008l.004-.011l.017-.43l-.003-.012l-.01-.01z"/><path fill="currentColor" d="M2 12.08c-.006-.862.91-1.356 1.618-.975l.095.058l2.678 1.804c.972.655.377 2.143-.734 2.007l-.117-.02l-1.063-.234a8.002 8.002 0 0 0 14.804.605a1 1 0 0 1 1.82.828c-1.987 4.37-6.896 6.793-11.687 5.509A10 10 0 0 1 2 12.08m.903-4.228C4.89 3.482 9.799 1.06 14.59 2.343a10 10 0 0 1 7.414 9.581c.007.863-.91 1.358-1.617.976l-.096-.058l-2.678-1.804c-.972-.655-.377-2.143.734-2.007l.117.02l1.063.234A8.002 8.002 0 0 0 4.723 8.68a1 1 0 1 1-1.82-.828"/></g></svg>
                    </button>
                 `
                 this.randomArticleContainer
                    .querySelector('button#random-refresh')
                    ?.addEventListener('click', (event) => {
                       event.preventDefault()
                       this.displayRandomArticle()
                    })
              }

              showAuthorArticles(author, avatar, link) {
                 if (!document.getElementById('fclite-modal')) {
                    const modal = this.createElement('div', { id: 'modal', className: 'modal' })
                    modal.innerHTML = `
                    <div class="modal-content">
                       <div class="modal-header">
                          <img class="modal-author-avatar" src="${avatar || this.config.error_img}" alt="">
                          <a class="modal-author-name-link" href="${new URL(link.toString()).origin}" target="_blank">${author}</a>
                       </div>
                       <div id="modal-articles-container"></div>
                    </div>
                    `
                    this.root.appendChild(modal)
                 }
                 this.modal = document.getElementById('modal')
                 const modalArticlesContainer = document.getElementById(
                    'modal-articles-container'
                 )
                 const authorArticles = this.allArticles.filter((article) => article.author === author)
                 modalArticlesContainer.innerHTML = ''
                 authorArticles.slice(0, 4).forEach((article) => {
                    const articleTemplate = `
                       <div class="modal-article">
                          <a class="modal-article-title" href="${article.link instanceof URL ? article.link.toString() : article.link}" target="_blank">${article.title}</a>
                          <div class="modal-article-date">${article.created.substring(0, 10)}</div>
                       </div>`
                    modalArticlesContainer.insertAdjacentHTML('beforeend', articleTemplate)
                 })

                 this.modal.style.display = 'block'
                 setTimeout(() => {
                    this.modal.classList.add('modal-open')
                 }, 10)
              }

              hideModal() {
                 this.modal.classList.remove('modal-open')
                 this.modal.addEventListener(
                    'transitionend',
                    () => {
                       this.modal.style.display = 'none'
                       this.root.removeChild(this.modal)
                    },
                    { once: true }
                 )
              }
           }

           // 初始化友链朋友圈
           const fc = new FriendCircle()
           fc.init({
              private_api_url: 'https://fc.mcyzsx.top/',
              page_turning_number: 10,
              error_img: 'https://cravatar.cn/avatar/57d8260dfb55501c37dde588e7c3852c'
           })
           fc.load()
        </script>
      </div>

      <!-- 申请说明区域 -->
      <div class="grid gap-8 mb-8">
        <!-- 本站信息卡片 -->
        <div
          class="bg-gray-300/30 dark:bg-gray-800/30 backdrop-blur-md rounded-[25px] p-6 border border-white/20 dark:border-gray-700/30 hover:bg-gray-300/50 dark:hover:bg-gray-800/50 animate-fade-in-up"
          style="animation-delay: 0.6s"
        >
          <div class="text-center mb-2">
            <h3
              class="text-xl font-semibold text-txt-light dark:text-darkmode-txt-light mb-2"
            >
              本站信息
            </h3>
            <p
              class="text-sm text-txt-light/70 dark:text-darkmode-txt-light/70"
            >
              请先添加本站友链后再申请
            </p>
          </div>

          <div class="space-y-2">
            <div
              class="grid grid-flow-col gap-4 justify-start items-center px-3"
            >
              <span class="w-fit font-medium text-blue-600 dark:text-blue-400"
                >网站名称</span
              >
              <span
                class="col-start-auto text-txt-light dark:text-darkmode-txt-light"
                >{SITE_INFO.SITE_NAME}</span
              >
            </div>
            <div
              class="grid grid-flow-col gap-4 justify-start items-center px-3"
            >
              <span class="w-fit font-medium text-blue-600 dark:text-blue-400"
                >作者昵称</span
              >
              <span
                class="col-start-auto text-txt-light dark:text-darkmode-txt-light"
                >{SITE_INFO.AUTHOR}</span
              >
            </div>
            <div
              class="grid grid-flow-col gap-4 justify-start items-center px-3"
            >
              <span class="w-fit font-medium text-blue-600 dark:text-blue-400"
                >网站地址</span
              >
              <span
                class="col-start-auto text-txt-light dark:text-darkmode-txt-light break-all under"
                ><a class="under" href={SITE_INFO.URL}
                  >{SITE_INFO.URL}</a
                ></span
              >
            </div>
            <div
              class="grid grid-flow-col gap-4 justify-start items-center px-3"
            >
              <span class="w-fit font-medium text-blue-600 dark:text-blue-400"
                >网站描述</span
              >
              <span
                class="col-start-auto text-txt-light dark:text-darkmode-txt-light"
                >{SITE_INFO.DESCRIPTION}</span
              >
            </div>
            <div
              class="grid grid-flow-col gap-4 justify-start items-center px-3"
            >
              <span class="w-fit font-medium text-blue-600 dark:text-blue-400"
                >网站头像</span
              >
              <span
                class="col-start-auto text-txt-light dark:text-darkmode-txt-light break-all"
              >
                <a
                  class="under"
                  href={SITE_INFO.LOGO_IMAGE}
                  target="_blank">{SITE_INFO.URL}{SITE_INFO.LOGO_IMAGE}</a
                >
              </span>
            </div>
            <div
              class="grid grid-flow-col gap-4 justify-start items-center px-3"
            >
              <span class="w-fit font-medium text-blue-600 dark:text-blue-400"
                >RSS订阅</span
              >
              <span
                class="col-start-auto text-txt-light dark:text-darkmode-txt-light break-all"
              >
                <a
                  class="under"
                  href={SITE_INFO.URL + "/rss.xml"}
                  target="_blank">{SITE_INFO.URL + "/rss.xml"}</a
                >
              </span>
            </div>
          </div>
        </div>

        <!-- 申请要求卡片 -->
        <div
          class="bg-gray-300/30 dark:bg-gray-800/30 hover:bg-gray-300/50 dark:hover:bg-gray-800/50 backdrop-blur-md rounded-[25px] p-6 border border-white/20 dark:border-gray-700/30 animate-fade-in-up"
          style="animation-delay: 0.6s"
        >
          <div class="text-center mb-6">
            <h3
              class="text-xl font-semibold text-txt-light dark:text-darkmode-txt-light mb-2"
            >
              申请要求
            </h3>
            <p
              class="text-sm text-txt-light/70 dark:text-darkmode-txt-light/70"
            >
              请确保符合以下基本要求
            </p>
          </div>

          <div class="space-y-3">
            <div class="flex items-center gap-3 px-3">
              <div class="w-4 h-4 bg-orange-300 rounded-full flex-shrink-0">
              </div>
              <div>
                <div class="text-txt-light dark:text-darkmode-txt-light">
                  已经添加<a class="under" href="https://myblog.zsxcoder.top"
                    >ZSXの小站</a
                  >的友情链接
                </div>
              </div>
            </div>
            <div class="flex items-center gap-3 px-3">
              <div class="w-4 h-4 bg-orange-400 rounded-full flex-shrink-0">
              </div>
              <div>
                <div class="text-txt-light dark:text-darkmode-txt-light">
                  网站主体为<b>个人</b>，网站类型为<b>博客</b>
                </div>
              </div>
            </div>
            <div class="flex items-center gap-3 px-3">
              <div class="w-4 h-4 bg-orange-400 rounded-full flex-shrink-0">
              </div>
              <div>
                <div class="text-txt-light dark:text-darkmode-txt-light">
                  网站现在可以在中国大陆区域正常访问
                </div>
              </div>
            </div>
            <div class="flex items-center gap-3 px-3">
              <div class="w-4 h-4 bg-orange-500 rounded-full flex-shrink-0">
              </div>
              <div>
                <div class="text-txt-light dark:text-darkmode-txt-light">
                  网站内容遵守中国大陆相关法律法规
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- 申请格式和须知区域 -->
      <div
        class=" backdrop-blur-md rounded-[25px] p-6 mb-16 animate-fade-in-up"
        style="animation-delay: 0.6s"
      >
        <div class="text-center mb-6">
          <h3
            class="text-xl font-semibold text-txt-light dark:text-darkmode-txt-light mb-2"
          >
            申请格式与须知
          </h3>
          <p class="text-sm text-txt-light/70 dark:text-darkmode-txt-light/70">
            请按照格式提交申请，并了解相关须知
          </p>
        </div>

        <!-- Tab 切换按钮 -->
        <div class="flex justify-center mb-6">
          <div
            class="bg-white/5 dark:bg-gray-700/20 rounded-lg p-1 border border-white/10 dark:border-gray-600/20"
          >
            <button
              id="format-tab"
              class="tab-btn px-4 py-2 rounded-full font-medium transition-all duration-200 bg-blue-500 text-white"
              onclick="switchTab('format')"
            >
              申请格式
            </button>
            <button
              id="notice-tab"
              class="tab-btn px-4 py-2 rounded-full font-medium transition-all duration-200 text-txt-light dark:text-darkmode-txt-light hover:bg-white/10 dark:hover:bg-gray-600/20"
              onclick="switchTab('notice')"
            >
              申请须知
            </button>
            <button
              id="disclaimer-tab"
              class="tab-btn px-4 py-2 rounded-full font-medium transition-all duration-200 text-txt-light dark:text-darkmode-txt-light hover:bg-white/10 dark:hover:bg-gray-600/20"
              onclick="switchTab('disclaimer')"
            >
              免责声明
            </button>
          </div>
        </div>

        <!-- 申请格式内容 -->
        <div id="format-content" class="tab-content">
          <div
            class="bg-gray-900 rounded-[18px] border border-gray-700 overflow-hidden mb-4"
          >
            <div
              class="flex justify-between items-center px-4 py-2 bg-gray-800 border-b border-gray-700"
            >
              <span class="text-md font-medium text-gray-300">申请模板</span>
              <button
                id="copy-btn"
                onclick="copyTemplate()"
                class="text-md text-blue-400 hover:text-blue-300 transition-colors duration-200"
              >
                复制模板
              </button>
            </div>
            <pre
              class="p-4 text-gray-300 overflow-x-auto"><code>网站名称：[您的网站名称]&#10;网站地址：[https://您的域名]&#10;网站描述：[简短描述，不超过30字]&#10;网站头像：[头像/Logo链接]</code></pre>
          </div>

          <div class="flex justify-center gap-4">
            <GlassButton variant="warning" onClick="autoFillApplication()">
              一键申请
            </GlassButton>
          </div>
        </div>

        <!-- 申请须知内容 -->
        <div id="notice-content" class="tab-content hidden">
          <div class="space-y-4">
            <div class="space-y-3">
              <div
                class="flex items-center gap-2 text-txt-light dark:text-darkmode-txt-light"
              >
                <div
                  class="w-3 h-3 border-2 border-blue-500 rounded-full flex-shrink-0"
                >
                </div>
                <span>符合基本加入条件</span>
              </div>
              <div
                class="flex items-center gap-2 text-txt-light dark:text-darkmode-txt-light"
              >
                <div
                  class="w-3 h-3 border-2 border-blue-500 rounded-full flex-shrink-0"
                >
                </div>
                <span>志趣相投的博客优先加入</span>
              </div>
              <div
                class="flex items-center gap-2 text-txt-light dark:text-darkmode-txt-light"
              >
                <div
                  class="w-3 h-3 border-2 border-blue-500 rounded-full flex-shrink-0"
                >
                </div>
                <span>申请友链的网站不要求备案情况</span>
              </div>
              <div
                class="flex items-center gap-2 text-txt-light dark:text-darkmode-txt-light"
              >
                <div
                  class="w-3 h-3 border-2 border-blue-500 rounded-full flex-shrink-0"
                >
                </div>
                <span
                  >如申请友链的域名使用不属于您的二级域名，将视博客内容情况决定是否添加友链</span
                >
              </div>
              <div
                class="flex items-center gap-2 text-txt-light dark:text-darkmode-txt-light"
              >
                <div
                  class="w-3 h-3 border-2 border-blue-500 rounded-full flex-shrink-0"
                >
                </div>
                <span>如您的博客存在信息变更，请在评论区清晰留言即可</span>
              </div>
              <div
                class="flex items-center gap-2 text-txt-light dark:text-darkmode-txt-light"
              >
                <div
                  class="w-3 h-3 border-2 border-blue-500 rounded-full flex-shrink-0"
                >
                </div>
                <span>如您的博客单方面删除本站友链，本站将不做通知静默下链</span
                >
              </div>
              <div
                class="flex items-center gap-2 text-txt-light dark:text-darkmode-txt-light"
              >
                <div
                  class="w-3 h-3 border-2 border-blue-500 rounded-full flex-shrink-0"
                >
                </div>
                <span
                  >如您的博客长期处于高度不完整状态，您的友链将被置于末端</span
                >
              </div>
              <div
                class="flex items-center gap-2 text-txt-light dark:text-darkmode-txt-light"
              >
                <div
                  class="w-3 h-3 border-2 border-blue-500 rounded-full flex-shrink-0"
                >
                </div>
                <span>如您的博客已停办/准备停办，请在评论中留言下链</span>
              </div>
              <div
                class="flex items-center gap-2 text-txt-light dark:text-darkmode-txt-light"
              >
                <div
                  class="w-3 h-3 border-2 border-blue-500 rounded-full flex-shrink-0"
                >
                </div>
                <span
                  >不定期随机访问过程中出现异常的友链将被置入异常友链范围，异常恢复后将回归原位（可通过评论提前告知异常恢复情况）</span
                >
              </div>
            </div>
          </div>
        </div>

        <!-- 免责声明内容 -->
        <div id="disclaimer-content" class="tab-content hidden">
          <div class="space-y-6">
            <div
              class="text-txt-light dark:text-darkmode-txt-light leading-relaxed"
            >
              <p class="mb-4">
                本博客遵守中华人民共和国相关法律。本页内容仅作为方便学习而产生的快速链接的链接方式，对与友情链接中存在的链接、好文推荐链接等均为其他网站。我本人能力有限无法逐个甄别每篇文章的每个字，并无法获知是否在收录后原作者是否对链接增加了违反法律甚至其他破坏用户计算机等行为。因为部分友链网站甚至没有做备案、域名并未做实名认证等，所以友链网站均可能存在风险，请你须知。
              </p>

              <p class="mb-4 font-medium">
                所以在我力所能及的情况下，我会包括但不限于：
              </p>

              <div class="space-y-2 mb-4 pl-4">
                <div class="flex items-center gap-2">
                  <div
                    class="w-3 h-3 border-2 border-blue-500 rounded-full flex-shrink-0"
                  >
                  </div>
                  <span
                    >针对收录的博客中的绝大多数内容通过标题来鉴别是否存在有风险的内容</span
                  >
                </div>
                <div class="flex items-center gap-2">
                  <div
                    class="w-3 h-3 border-2 border-blue-500 rounded-full flex-shrink-0"
                  >
                  </div>
                  <span>在收录的友链好文推荐中检查是否存在风险内容</span>
                </div>
              </div>

              <p class="mb-4 font-medium">
                但是你在访问的时候，仍然无法避免，包括但不限于：
              </p>

              <div class="space-y-2 mb-4 pl-4">
                <div class="flex items-start gap-2">
                  <div
                    class="w-1.5 h-1.5 bg-red-500 rounded-full mt-2 flex-shrink-0"
                  >
                  </div>
                  <span>作者更换了超链接的指向，替换成了其他内容</span>
                </div>
                <div class="flex items-start gap-2">
                  <div
                    class="w-1.5 h-1.5 bg-red-500 rounded-full mt-2 flex-shrink-0"
                  >
                  </div>
                  <span>作者的服务器被恶意攻击、劫持、被注入恶意内容</span>
                </div>
                <div class="flex items-start gap-2">
                  <div
                    class="w-1.5 h-1.5 bg-red-500 rounded-full mt-2 flex-shrink-0"
                  >
                  </div>
                  <span>作者的域名到期，被不法分子用作他用</span>
                </div>
                <div class="flex items-start gap-2">
                  <div
                    class="w-1.5 h-1.5 bg-red-500 rounded-full mt-2 flex-shrink-0"
                  >
                  </div>
                  <span>作者修改了文章内容，增加钓鱼网站、广告等无效信息</span>
                </div>
                <div class="flex items-start gap-2">
                  <div
                    class="w-1.5 h-1.5 bg-red-500 rounded-full mt-2 flex-shrink-0"
                  >
                  </div>
                  <span>不完善的隐私保护对用户的隐私造成了侵害、泄漏</span>
                </div>
              </div>

              <div
                class="border-l-4 text-yellow-800 dark:text-yellow-200 border-yellow-500 pl-4 py-3 bg-yellow-50 dark:bg-yellow-900/20 rounded-r"
              >
                <p class="mb-2">
                  如果你发现其中包含违反中华人民共和国法律的内容，请即使联系和举报。该友链会被拉黑。
                </p>
                <p class="">
                  如果因为从本页跳转给你造成了损失，深表歉意，并且建议用户如果发现存在问题在本页面进行回复。我会尽快处理。
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- 分割线 -->
      <div class="my-12 border-t border-gary-300/50 dark:border-gray-700/50"></div>

      <!-- 留言区域 -->
      <div
        id="留言区"
        class="bg-gray-300/50 dark:bg-gray-800/50 rounded-[25px] p-8 border border-white/20 dark:border-gray-700/30 animate-fade-in-up"
        style="animation-delay: 1s"
      >
        <h2
          class="text-2xl font-bold text-txt-p dark:text-darkmode-txt-p mb-6 text-center"
        >
          留言交流
        </h2>
        <p class="text-center text-txt-light dark:text-darkmode-txt-light mb-6">
          欢迎在这里申请友链或进行交流讨论
        </p>
        <!-- Twikoo 评论系统 -->
        <Comment />
      </div>
    <!-- </div> -->
    </LiquidGlassLess>

    <script>
      // Tab 切换功能
      function switchTab(tabName: string) {
        // 隐藏所有内容
        document.querySelectorAll(".tab-content").forEach((content) => {
          content.classList.add("hidden");
        });

        // 重置所有按钮样式
        document.querySelectorAll(".tab-btn").forEach((btn) => {
          btn.classList.remove("bg-blue-500", "text-white");
          btn.classList.add(
            "text-txt-light",
            "dark:text-darkmode-txt-light",
            "hover:bg-white/10",
            "dark:hover:bg-gray-600/20",
          );
        });

        // 显示选中的内容
        const content = document.getElementById(tabName + "-content");
        if (content) {
          content.classList.remove("hidden");
        } else {
          console.error(`未找到 ID 为 ${tabName}-content 的元素`);
        }

        // 激活选中的按钮
        const activeBtn = document.getElementById(
          tabName + "-tab",
        ) as HTMLButtonElement;

        activeBtn.classList.add("bg-blue-500", "text-white");
        activeBtn.classList.remove(
          "text-txt-light",
          "dark:text-darkmode-txt-light",
          "hover:bg-white/10",
          "dark:hover:bg-gray-600/20",
        );
      }

      // 一键申请功能
      function autoFillApplication() {
        const template = `网站名称：[您的网站名称]\n网站地址：[https://您的域名]\n网站描述：[简短描述，不超过30字]\n网站头像：[头像/Logo链接]`;

        // 滚动到留言区域
        const commentSection = document.getElementById("留言区");
        if (commentSection) {
          commentSection.scrollIntoView({ behavior: "smooth" });

          // 等待滚动完成后尝试填充内容
          setTimeout(() => {
            // 尝试找到 Twikoo 的输入框
            const textarea = document.querySelector(
              "#tcomment textarea, .tk-input textarea, .twikoo textarea",
            ) as HTMLTextAreaElement;
            if (textarea) {
              textarea.value = template;
              textarea.focus();
              // 触发输入事件以确保 Twikoo 检测到内容变化
              textarea.dispatchEvent(new Event("input", { bubbles: true }));
            } else {
              // 如果找不到输入框，复制到剪贴板
              navigator.clipboard
                .writeText(template)
                .then(() => {
                  alert("申请模板已复制到剪贴板，请粘贴到留言框中！");
                })
                .catch(() => {
                  alert("请手动复制申请模板到留言框中");
                });
            }
          }, 1000);
        }
      }

      // 复制模板功能
      function copyTemplate() {
        const template = `网站名称：[您的网站名称]\n网站地址：[https://您的域名]\n网站描述：[简短描述，不超过30字]\n网站头像：[头像/Logo链接]`;

        navigator.clipboard
          .writeText(template)
          .then(() => {
            // 显示复制成功提示
            const btn = document.getElementById(
              "copy-btn",
            ) as HTMLButtonElement;
            const originalText = btn.textContent;
            btn.textContent = "已复制";
            btn.style.color = "#10b981";

            setTimeout(() => {
              btn.textContent = originalText;
              btn.style.color = "";
            }, 2000);
          })
          .catch((err) => {
            console.error("复制失败:", err);
            alert("复制失败，请手动复制模板内容：" + err);
          });
      }

      // 滚动到留言区功能
      function scrollToComments() {
        const commentSection = document.getElementById("留言区");
        if (commentSection) {
          commentSection.scrollIntoView({ behavior: "smooth" });
        }
      }

      // 将函数绑定到全局作用域
      (window as any).switchTab = switchTab;
      (window as any).autoFillApplication = autoFillApplication;
      (window as any).copyTemplate = copyTemplate;
      (window as any).scrollToComments = scrollToComments;
    </script>
  </section>

  <style>
    /* 基础动画 */
    @keyframes fade-in-down {
      from {
        opacity: 0;
        transform: translateY(-40px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes fade-in-up {
      from {
        opacity: 0;
        transform: translateY(40px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .animate-fade-in-down {
      animation: fade-in-down 0.8s ease-out;
    }

    .animate-fade-in-up {
      animation: fade-in-up 0.8s ease-out both;
      opacity: 0;
      transform: translateY(40px);
    }

    /* 减少动画效果（用户偏好） */
    @media (prefers-reduced-motion: reduce) {
      .animate-fade-in-down,
      .animate-fade-in-up {
        animation: none;
        opacity: 1;
        transform: none;
      }
    }
  </style>
</BaseLayout>
